
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using Luban;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

namespace cfg
{
public partial class TablesComponent
{
    public bool IsLoading{get; private set;}
    public bool IsLoaded{get; private set;}

    public UI.TbForm TbForm {get; private set;}
    public UI.TbLayer TbLayer {get; private set;}

    public void LoadAll(System.Func<string, ByteBuf> loader)
    {
        TbForm = new UI.TbForm(loader("ui_tbform"));
        TbLayer = new UI.TbLayer(loader("ui_tblayer"));
        ResolveRef();
    }

    public async Task LoadAsync(System.Func<string, Task<ByteBuf>> loader)
    {
        IsLoading = true;
        IsLoaded = false;

        Dictionary<string, Task<ByteBuf>> tasks = new ();

        tasks["ui_tbform"] = loader("ui_tbform");
        tasks["ui_tblayer"] = loader("ui_tblayer");

        // Task.WaitAll(tasks.Values.ToArray());

        TbForm = new UI.TbForm(await tasks["ui_tbform"]);
        TbLayer = new UI.TbLayer(await tasks["ui_tblayer"]);

        ResolveRef();

        IsLoading = false;
        IsLoaded = true;
    }
    
    private void ResolveRef()
    {
        TbForm.ResolveRef(this);
        TbLayer.ResolveRef(this);
    }
}

}
